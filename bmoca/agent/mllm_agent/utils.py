import os
import cv2
import yaml
import base64
import numpy as np
import pyshine as ps

from PIL import Image

_WORK_PATH = os.environ["BMOCA_HOME"]
_CONFIG_PATH = f'{_WORK_PATH}/config/foundation_model_config.yaml'


def load_config(config_path=_CONFIG_PATH):
    configs = dict(os.environ)
    with open(config_path, "r") as file:
        yaml_data = yaml.safe_load(file)
    configs.update(yaml_data)
    return configs


def encode_image(image_path):
    with open(image_path, "rb") as image_file:
        return base64.b64encode(image_file.read()).decode('utf-8')


def PIL2OpenCV(pil_image):
    numpy_image= np.array(pil_image)
    opencv_image = cv2.cvtColor(numpy_image, cv2.COLOR_RGB2BGR)
    return opencv_image


def OpenCV2PIL(opencv_image):
    color_coverted = cv2.cvtColor(opencv_image, cv2.COLOR_BGR2RGB)
    pil_image = Image.fromarray(color_coverted)
    return pil_image
